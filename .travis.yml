os: linux
dist: trusty
language: java
jdk:
- openjdk8
if: |
  (branch IN (master, dev) AND commit_message !~ /^(bumped version to|release:) (\d+(\.\d+){2})(-.+)?$/) \
  OR tag =~ /^(\d+(\.\d+){2})([-+][\w\-\.+]+)?$/
git:
  depth: false
env:
  global:
    secure: c+uBHZjxeH465lXzg976Bgvu101hL7M3zgTqCTrhxOAfcCxuhWN7iJSH9ZmYjv8LQuX1aNVhK18cm7nxpc3gkwRgmT3XNX8oSlknxOxWM8ZlK2XTej4IgXubVp5gAcTnkFtywCX/S9xWQ2D3F3DCKStraW+C0fpIkyJ8gx67smho6u+bSPO2uIk9PfopkwK4cxrfC3l1ABMboWUDeYiRa/FlvxxWoMBHEgacbidbULybU/lW3Lr3dLZLzs8INR22bxxedSYH8GJpE9pBC+dUzpNn98hB2FXigZ9QWM7qHGpTqe+m8UCE5ForntSVq7lTk08tWWzv61OMBDOAWbBOrQXUTOA0i9tmSprURBUGR6ttGMUdvZShaWKFc8Xl65Iwal4JS+zWFteXKx/ZCF70P+CmEfZpg3wbycGzN9HhwTi+b1cls5XiRLAtp0PAMwZwMymw3B2amzUhuNCd47NAwZmZcYwvx7iySGtotldnfgCTDfVV/Q1JxgYys7MAO9UHS3CK/dTqGUhdDhc0ww6t6mGr58NTyJpWBA6ZFQyhz6qf/fV4pm8n4cBB/eJGBj4F3T3GH4Wdbanri20BUw3XKJMET7QwJHtUxcUaSJOFj9wYdf93bPFnVFzsM96H4I8D1m6teMC1iun9yWfJjeh+hgfXhrLClVUTq66q7QHW52E=
before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
cache:
  directories:
  - ".autoconf"
  - "$HOME/.m2"
  - "$HOME/.gradle/caches/modules-2/"
  - "$HOME/.gradle/wrapper/dists/"
before_install:
- openssl aes-256-cbc -K $encrypted_2afbb999f001_key -iv $encrypted_2afbb999f001_iv
  -in gradle.properties.enc -out gradle.properties -d
- openssl aes-256-cbc -K $encrypted_70811ee8b6a1_key -iv $encrypted_70811ee8b6a1_iv
  -in .travis/secret.gpg.enc -out .travis/secret.gpg -d
- git config --global user.name "Travis CI"
- git config --global user.email "travis.ci@yi.team"
- chmod +x ./gradlew .travis/*.sh
- ls -lh
- git log --graph --full-history --all --color --date=short --pretty=format:"%Cred%x09%h
  %Creset%ad%Cgreen%d %Creset %s %C(bold)(%an)%Creset" || true
install: "/bin/true"
script:
- "./gradlew clean"
deploy:
- provider: script
  skip_cleanup: true
  cleanup: false
  script: ".travis/deploy-snapshot.sh"
  on:
    branch: master
- provider: script
  skip_cleanup: true
  cleanup: false
  script: ".travis/deploy-release.sh"
  on:
    tags: true
